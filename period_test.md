# Критерий Вальда-Вольфовица

Критерий Вальда - Вольфовица (тест прогонов) - непараметрический тест для проверки гипотезы о случайности для двух последовательностей данных одинаковой длины. Иными словами, использование для нуль-гипотезы для установки взаимной независимости элементов двух последовательностей.

# Определения

Для начала дадим определение прогону последовательности. Это непустой сегмент последовательности, состоящий из соседних равных элементов.

Положим, есть 14 элементов: +++---++++----

У нас имеется 4 прогона. 

По нулевой гипотезе, количество прогонов $$r$$ в последовательности из N элементов является случайной величиной, условное распределение которой, учитывая наблюдение $$N_+$$ и $$N_-$$ (полож. и отрицательных значений) является приблизительно нормальным $$(N=N_++N_-)$$, при этом:

Матожидание: $$E(N) = \frac{2N_+N_-}{N}+1$$

Дисперсия: $$D(N) = \frac{2N_+N_-(2N_+N_--N)}{N^2(N-1)}=\frac{(E(N)-2)(E(N)-1)}{N-1}$$

Контрольная величина: $$Z = \frac{r - E(N)}{\sqrt{D(N)}}$$

Следует отметить, что параметры не предполагают, что положительные и отрицательные элементы имеют равные вероятности появления, а только предполагают, что элементы независимы и одинаково распределены. Если количество прогонов значительно выше или ниже ожидаемого, то гипотеза о стат. независимости может быть отклонена.

# Применение

Данный тест используется при проверке случайности распределения данных в последовательности и соотнесение функции с датасетом (данные, превышающие значение функции, отмечаются положительным знаком, иначе – отрицательным).

# Пример

Рассматривается последовательность:
13	 3	14	14	1	14	3	8	14	17	9	14	13	2	16	1	3	12	13	14

Отнесем каждое значение данной последовательности к одной из 2 групп («+» или «–») с учетом того больше оно или меньше медианы = 13:

0	-10	1	1	-12	1	-10	-5	1	4	-4	1	0	-11	3	-12	-10	-1	0	1

Соотносим: +	-	+	+	-	+	-	-	+	+	-	+	+	-	+	-	-	-	+	+

При $$N_+=11$$, и $$N_-=9$$ получается $$r = 13$$ прогонов.

Матожидание:

$$E(20) = \frac{2 * 11 * 9}{20} + 1 = 10.9$$

Дисперсия:

$$D(20) = \frac{2 * 11 * 9 * (2 * 11 * 9 - 20)}{20^2 * 19} = 4.6$$

Контрольная величина:

$$z = \frac{13 - 10.9}{\sqrt{4.6}} = 0.98$$

Вывод:

При уровне значимости 0.05 $$H_0$$ отвергается, если $$| z | > 1.96$$

Результат:

Нуль-гипотеза не отвергается. Элементы выборки выбраны случайным образом.

### [Вернуться на главную](/)
